<html>
<head>
<!--
This style is adopted from the (now old) vagrant 1.0 web
pages. The style builds on the Twitter Bootstrap style.
Modifications by Hans Petter Langtangen, hpl@simula.no.

This style file should be copied and the following
elements edited:

Logo heading:

 LogoWord
 withSubWord

Navigation links at the top:

 GO TO 1
 GO TO 2

Footer at the end:

 Here goes a footer, if desired, maybe with a Copyright &copy;

-->

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: http://code.google.com/p/doconce/" />

<link rel="stylesheet" href="css/twitter_bootstrap.css">
<link rel="stylesheet" href="css/vagrant.css">
<!-- Define color of headings here (last definition counts) -->
<style type="text/css">
h1, h2, h3, h4, h5, h6 {
  color: #000;     /* black */
  color: #999;     /* gray */
  color: #005580;  /* dark blue */
  color: #08c;     /* characteristic blue */
</style>
</head>
<body>

<title> Documentation of Vagrant </title>

<div class="container">
 <div class="row Header with-border">
  <div class="span3 Module logo">
   <h1><a href="/">Vagrant<span class="subtitle">4scientists</span></a></h1>
  </div>
  <div class="span9">
   <div class="Module navigation">
   <!-- Navigation at the top of the page -->
    <ul>
     <li> <a href="http://docs.vagrantup.com/v2/">Vagrant docs</a></li>
    </ul>
   </div>
  </div>
 </div>
</div>


<!-- Here goes the table of contents in the sidebar
     <li class="active"> means dark blue background for current section
-->
<div class="row">
 <div class="span3 Module sidebar">
  <div class="well" style="padding: 8px 0px;">
   <ul class="nav nav-list">
     <!-- Syntax:
     <li> <a href="...">Section 1</a></li>
     <li class="active"> <a href="...">Section 2</a></li>
     <li> &nbsp;&nbsp;&nbsp; <a href="...">Section 2a</a></li>
     <li> &nbsp;&nbsp;&nbsp; <a href="...">Section 2b</a></li>
     -->
     <!-- Doconce automatically fills in the table of contents -->
          <!-- vagrant nav toc: " Problem setting " --> <li>  <a href="._part0001_vagrant_box.html#___sec0"> Problem setting </a>
     <!-- vagrant nav toc: " Contents of the Vagrant machine " --> <li> &nbsp;  <a href="._part0001_vagrant_box.html#vagrant:contents"> Contents of the Vagrant machine </a>
     <!-- vagrant nav toc: " Installing Vagrant " --> <li> &nbsp;  <a href="._part0002_vagrant_box.html#vagrant:install"> Installing Vagrant </a>
     <!-- vagrant nav toc: " Creating the Vagrant machine " --> <li>  <a href="._part0003_vagrant_box.html#___sec3"> Creating the Vagrant machine </a>
     <!-- vagrant nav toc: " Choice of operating system type " --> <li> &nbsp;  <a href="._part0003_vagrant_box.html#___sec4"> Choice of operating system type </a>
     <!-- vagrant nav toc: " Installing packages " --> <li> &nbsp;  <a href="._part0004_vagrant_box.html#___sec5"> Installing packages </a>
     <!-- vagrant nav toc: " Setting up a default environment with <code>.bashrc</code> " --> <li> &nbsp;  <a href="._part0005_vagrant_box.html#___sec6"> Setting up a default environment with <code>.bashrc</code> </a>
     <!-- vagrant nav toc: " Adding X11 support " --> <li> &nbsp;  <a href="._part0006_vagrant_box.html#___sec7"> Adding X11 support </a>
     <!-- vagrant nav toc: " Finalizing the machine " --> <li> &nbsp;  <a href="._part0006_vagrant_box.html#___sec8"> Finalizing the machine </a>
     <!-- vagrant nav toc: " Operating the Vagrant machine " --> <li class="active">  <a href="._part0007_vagrant_box.html#___sec9"> Operating the Vagrant machine </a>
     <!-- vagrant nav toc: " Shared folders " --> <li> &nbsp;  <a href="._part0007_vagrant_box.html#vagrant:shareddir"> Shared folders </a>
     <!-- vagrant nav toc: " Troubleshooting: shared folder is invisible " --> <li> &nbsp; &nbsp;  <a href="._part0007_vagrant_box.html#___sec11"> Troubleshooting: shared folder is invisible </a>
     <!-- vagrant nav toc: " Troubleshooting: "couldn't connect to display ..." " --> <li> &nbsp; &nbsp;  <a href="._part0007_vagrant_box.html#___sec12"> Troubleshooting: "couldn't connect to display ..." </a>
     <!-- vagrant nav toc: " Stopping the Vagrant machine " --> <li> &nbsp;  <a href="._part0007_vagrant_box.html#___sec13"> Stopping the Vagrant machine </a>
     <!-- vagrant nav toc: " Using VMWare Fusion " --> <li> &nbsp;  <a href="._part0007_vagrant_box.html#___sec14"> Using VMWare Fusion </a>
     <!-- vagrant nav toc: " Documentation of Vagrant " --> <li> &nbsp;  <a href="._part0007_vagrant_box.html#___sec15"> Documentation of Vagrant </a>

    </ul>
   </div>
  </div>

  <div class="span9">


<!-- tocinfo
{'highest level': 1,
 'sections': [(' Problem setting ', 1, None, '___sec0'),
              (' Contents of the Vagrant machine ',
               2,
               'vagrant:contents',
               'vagrant:contents'),
              (' Installing Vagrant ',
               2,
               'vagrant:install',
               'vagrant:install'),
              (' Creating the Vagrant machine ', 1, None, '___sec3'),
              (' Choice of operating system type ', 2, None, '___sec4'),
              (' Installing packages ', 2, None, '___sec5'),
              (' Setting up a default environment with `.bashrc` ',
               2,
               None,
               '___sec6'),
              (' Adding X11 support ', 2, None, '___sec7'),
              (' Finalizing the machine ', 2, None, '___sec8'),
              (' Operating the Vagrant machine ', 1, None, '___sec9'),
              (' Shared folders ',
               2,
               'vagrant:shareddir',
               'vagrant:shareddir'),
              (' Troubleshooting: shared folder is invisible ',
               3,
               None,
               '___sec11'),
              (' Troubleshooting: "couldn\'t connect to display ..." ',
               3,
               None,
               '___sec12'),
              (' Stopping the Vagrant machine ', 2, None, '___sec13'),
              (' Using VMWare Fusion ', 2, None, '___sec14'),
              (' Documentation of Vagrant ', 2, None, '___sec15')]}
end of tocinfo -->





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">




<a name="part0007"></a>
<!-- !split -->

<h2>Operating the Vagrant machine  <a name="___sec9"></a></h2>

<p>
The Vagrant machine <code>ourpackage.box</code>, created above, can now be
distributed together with <code>Vagrantfile</code>
to everyone working on a project to ensure that they all
have the same software versions, no matter if they are using Windows,
Mac, or Linux. Here is the user's recipe.

<p>
<b>Step 1.</b>
Install VirtualBox and Vagrant as described in
the section <a href="._part0002_vagrant_box.html#vagrant:install">Installing Vagrant</a>.

<p>
<b>Step 2.</b>
Run the commands

<p>

<!-- code=bash (from !bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; vagrant box add ourpackage ourpackage.box
</pre></div>
<p>

<!-- begin inline comment -->
<font color="red">[<b>hpl 3</b>: <em>Is this command necessary for users?</em>]</font>
<!-- end inline comment -->


<p>

<!-- begin inline comment -->
<font color="red">[<b>Anders 4</b>: <em>It depends. We actually should not distribute both a Vagrantfile
and a box. We could i) distribute just a Vagrantfile (plus install scripts)
with a lot of configurations. This Vagrantfile must contain a
URL to a box. The user may then start with Step 3 below. Or ii) distribute just
a box. In this case, a Vagrantfile with configurations can be added to the box
when packing it. With this approach the step above is highly necessary, and should
be succeeded by the command 'vagrant init ourpackage' before continuing to Step 3.</em>]</font>
<!-- end inline comment -->


<p>
<b>Step 3.</b>
Start (boot) the Vagrant machine:

<p>

<!-- code=bash (from !bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; vagrant up
</pre></div>
<p>
<b>Step 4.</b>
Log in on the machine:

<p>

<!-- code=bash (from !bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; vagrant ssh
</pre></div>
<p>
Log out with Ctrl-D as usual in Unix terminal windows.

<p>
<b>Step 5 (if necessary).</b>
If the <code>Vagrantfile</code> does not contain the string "install.sh", the
<code>install.sh</code> script must be run inside the box:

<p>

<!-- code=bash (from !bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; bash -x /vagrant/install.sh
</pre></div>

<h3>Shared folders <a name="vagrant:shareddir"></a></h3>

<p>
Inside the Vagrant machine, <code>/vagrant</code> is a folder shared with
the user's file system. More precisely, <code>/vagrant</code> points to the
<em>project folder</em> where the file <code>Vagrantfile</code> resides and where we ran the
<code>vagrant up</code> command. If users of the Vagrant machine keeps all their
files relevant for the machine in the project folder and its
subfolders, all these folders will be shared between the
machine and the user's file system. Normally, this feature is
enough for efficient communication of files between the
Vagrant machine's file system and the user's file system.
One can also set up other shared folders, see
the Vagrant documentation for <a href="http://docs.vagrantup.com/v2/synced-folders/basic_usage.html">Synced Folders</a>.

<p>
Since the Vagrant machine shares folders with the host system, users
can safely edit files in the shared folders with their favorite editor
on the host system. The Vagrant machine will have immediate access to
the files.

<p>
Here is a typical example. Assume that <code>vagrant up</code> and <code>vagrant ssh</code>
were run in a folder <code>myubuntu</code>. On the host machine,
create a subfolder <code>src</code> of <code>myubuntu</code>. Start an editor and type in
the following Python program in a file <code>test1.py</code>:

<p>

<!-- code=python (from !bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">4*</span>np<span style="color: #666666">.</span>pi, <span style="color: #666666">501</span>)
y <span style="color: #666666">=</span> np<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span>x<span style="color: #666666">/2.</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>sin(x)
plt<span style="color: #666666">.</span>plot(x, y)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
This program will show X11 graphics on your host machine. If this machine
runs the Linux operating system, everything is fine, but if this is a Mac
or Windows machine, X11 must be started. On a Mac, open Finder, go to
Applications, and then the Utilities subfolder, and double-click <code>X11.app</code>
to start X11.

<p>
Log out of the Vagrant machine (<code>Ctrl-D</code>) and log in again (<code>vagrant ssh</code>).
Move to the <code>src</code> folder and run the <code>test1.py</code> program:

<p>

<!-- code=bash (from !bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; <span style="color: #008000">cd</span> /vagrant
Terminal&gt; <span style="color: #008000">cd </span>src
Terminal&gt; python test1.py
</pre></div>
<p>
A plot of the curve \( y = e^{-x/2}\sin x \) should now be seen on the screen.

<p>

<!-- begin inline comment -->
<font color="red">[<b>hpl 5</b>: <em>Anders, what to do with X11 on Windows?</em>]</font>
<!-- end inline comment -->


<p>

<!-- begin inline comment -->
<font color="red">[<b>Anders 6</b>: <em>hpl, could you please read the rest of this section, question everything
that seems unclear, rewrite the some of my bad formulations and put it in a
suitable place in the document?</em>]</font>
<!-- end inline comment -->


<p>
In Windows neither an ssh-client nor an X-server is installed by default. However,
both these issues can be solved by installing <a href="http://cygwin.com/install.html">Cygwin</a>.
Download the Cygwin's <a href="http://cygwin.com/setup.exe">setup.exe</a> and follow
the instructions given by the installer. Only the minimal base packages from
the Cygwin distribution are installed by default. This means that we need
manually to select the 'X11' category during installation to install Cygwin/X.

<p>

<!-- begin inline comment -->
<font color="red">[<b>Anders 7</b>: <em>Don't remember if the following was necessary. Need to check it next time I'm in Windows</em>]</font>
<!-- end inline comment -->


<p>
Once installed, we need to add Cygwin's ssh client to our
<code>PATH</code>. Cygwin is by default installed to <code>C:\cygwin</code>, so the command
is <code>set PATH=%PATH%;C:\cygwin\bin</code>.

<p>

<!-- begin inline comment -->
<font color="red">[<b>Anders 8</b>: <em>hpl, here's the recipe for distributing only the
Vagrantfile. Maybe copy this to the same place as the box?</em>]</font>
<!-- end inline comment -->


<p>
Cygwin's terminal, which now has both an ssh-client and an X-server,
can be started from Start - All Programs - Cygwin-X - XWin Server.  In
this terminal we can download a Vagrantfile with all necessary
configurations and start the Vagrant machine:

<p>

<!-- code=bash (from !bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; wget http://dl.dropboxusercontent.com/u/13793917/Vagrantfile
Terminal&gt; vagrant up
Terminal&gt; vagrant ssh
</pre></div>

<h4>Troubleshooting: shared folder is invisible  <a name="___sec11"></a></h4>

<p>
It may happen that the <code>/vagrant</code> folder seems empty inside
the Vagrant machine. Two steps will fix this problem. First,
run

<p>

<!-- code=bash (from !bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; sudo /etc/init.d/vboxadd setup
</pre></div>
<p>
<em>inside the Vagrant machine</em>. Second, log out and run

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; sudo vagrant reload
</pre></div>
<p>
<em>outside the Vagrant machine</em>.
Then do <code>vagrant ssh</code> and take an <code>ls /vagrant</code> to see that the
files in the project folder are visible.

<h4>Troubleshooting: "couldn't connect to display ..."  <a name="___sec12"></a></h4>

<p>
This error message points to the problem that X11 graphics on the
Vagrant machine cannot be shown on the host's screen.
Make sure the line with <code>config.ssh.forward_x11 = true</code> is present
in the file <code>Vagrantfile</code> in the project folder (see above).
Also make sure that X11 is running on the host computer (see above
for how to do this).

<p>
Each time the user wants to access the virtual environment, the
following two lines are enough:

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">vagrant up
vagrant ssh
</pre></div>

<h3>Stopping the Vagrant machine  <a name="___sec13"></a></h3>

<p>
There are three ways to stop the virtual Vagrant machine:

<p>

<ul>
 <li> <code>vagrant suspend</code> sends the machine to sleep mode. Waking it up is
   done with <code>vagrant resume</code>.</li>
 <li> <code>vagrant halt</code> shuts off the machine. To start it again, a full
   boot with <code>vagrant up</code> is needed.</li>
 <li> The machine can be removed forever by <code>vagrant destroy</code>.</li>
</ul>

<h3>Using VMWare Fusion  <a name="___sec14"></a></h3>

<p>
Not written yet.

<h3>Documentation of Vagrant  <a name="___sec15"></a></h3>

<p>

<ul>
 <li> <a href="http://docs.vagrantup.com/v2/">The official Vagrant documentation</a>
   targets web developers, but contains more details than the tutorial above.</li>
 <li> <a href="http://www.linuxjournal.com/content/introducing-vagrant">An article in The Linux Journal</a> is
   technically slightly outdated, but gives much valuable additional
   information.</li>
</ul>


<p>
<!-- ------------------- end of main content --------------- -->


<!--
Preliminary examples/discussion on vagrant style syntax

<div class='alert alert-block alert-notice'>
  <h3>What about PHP? Python? Java?</h3>
<p>
bla-bla.
</div>

<p>
While the <div class="deep-blue">rest of the</div> getting started
-->

<ul class="pager">
  <li class="previous">
    <a href="._part0006_vagrant_box.html">&larr; Prev</a>
  </li>


</ul>

 </div>

 <div class="row Footer">
  <div class="span12">
  Copyright &copy 2013; Anders E. Johansen and Hans Petter Langtangen
  </div>
 </div>
</div>
</body>
</html>



