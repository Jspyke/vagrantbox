<html>
<head>
<!--
This style is adopted from the (now old) vagrant 1.0 web
pages. The style builds on the Twitter Bootstrap style.
Modifications by Hans Petter Langtangen, hpl@simula.no.

This style file should be copied and the following
elements edited:

Logo heading:

 LogoWord
 withSubWord

Navigation links at the top:

 GO TO 1
 GO TO 2

Footer at the end:

 Here goes a footer, if desired, maybe with a Copyright &copy;

-->

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: http://code.google.com/p/doconce/" />

<link rel="stylesheet" href="https://raw.githubusercontent.com/hplgit/doconce/master/bundled/html_styles/style_vagrant/css/twitter_bootstrap.css">
<link rel="stylesheet" href="https://raw.githubusercontent.com/hplgit/doconce/master/bundled/html_styles/style_vagrant/css/vagrant.css">

<!-- Define color of headings here (last definition counts) -->
<style type="text/css">
h1, h2, h3, h4, h5, h6 {
  color: #000;     /* black */
  color: #999;     /* gray */
  color: #005580;  /* dark blue */
  color: #08c;     /* characteristic blue */
</style>
</head>
<body>

<title> Troubleshooting: Internet is not reachable </title>

<div class="container">
 <div class="row Header with-border">
  <div class="span3 Module logo">
   <h1><a href="/">Vagrant<span class="subtitle">4scientists</span></a></h1>
  </div>
  <div class="span9">
   <div class="Module navigation">
   <!-- Navigation at the top of the page -->
    <ul>
     <li> <a href="http://docs.vagrantup.com/v2/">Vagrant docs</a></li>
    </ul>
   </div>
  </div>
 </div>
</div>


<!-- Here goes the table of contents in the sidebar
     <li class="active"> means dark blue background for current section
-->
<div class="row">
 <div class="span3 Module sidebar">
  <div class="well" style="padding: 8px 0px;">
   <ul class="nav nav-list">
     <!-- Syntax:
     <li> <a href="...">Section 1</a></li>
     <li class="active"> <a href="...">Section 2</a></li>
     <li> &nbsp;&nbsp;&nbsp; <a href="...">Section 2a</a></li>
     <li> &nbsp;&nbsp;&nbsp; <a href="...">Section 2b</a></li>
     -->
     <!-- Doconce automatically fills in the table of contents -->
          <!-- vagrant nav toc: " Problem setting " --> <li>  <a href="._vagrant_box001.html#___sec0"> Problem setting </a>
     <!-- vagrant nav toc: " Contents of the Vagrant machine " --> <li> &nbsp;  <a href="._vagrant_box001.html#vagrant:contents"> Contents of the Vagrant machine </a>
     <!-- vagrant nav toc: " Installing the necessary software for using Vagrant " --> <li> &nbsp;  <a href="._vagrant_box002.html#vagrant:install"> Installing the necessary software for using Vagrant </a>
     <!-- vagrant nav toc: " VirtualBox " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box002.html#___sec3"> VirtualBox </a>
     <!-- vagrant nav toc: " Vagrant " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box002.html#___sec4"> Vagrant </a>
     <!-- vagrant nav toc: " Cygwin (only on Windows) " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box002.html#___sec5"> Cygwin (only on Windows) </a>
     <!-- vagrant nav toc: " Creating the Vagrant machine " --> <li>  <a href="._vagrant_box003.html#___sec6"> Creating the Vagrant machine </a>
     <!-- vagrant nav toc: " Choice of operating system type " --> <li> &nbsp;  <a href="._vagrant_box003.html#___sec7"> Choice of operating system type </a>
     <!-- vagrant nav toc: " Downloading a base box to create a complete Vagrant machine " --> <li> &nbsp;  <a href="._vagrant_box003.html#___sec8"> Downloading a base box to create a complete Vagrant machine </a>
     <!-- vagrant nav toc: " Making an empty Vagrant machine " --> <li> &nbsp;  <a href="._vagrant_box003.html#___sec9"> Making an empty Vagrant machine </a>
     <!-- vagrant nav toc: " Installing packages in a complete Vagrant machine " --> <li> &nbsp;  <a href="._vagrant_box004.html#vagrant:complete:install"> Installing packages in a complete Vagrant machine </a>
     <!-- vagrant nav toc: " Creating files " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box004.html#___sec11"> Creating files </a>
     <!-- vagrant nav toc: " Installing files and packages " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box004.html#___sec12"> Installing files and packages </a>
     <!-- vagrant nav toc: " Enabling X11 graphics " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box004.html#___sec13"> Enabling X11 graphics </a>
     <!-- vagrant nav toc: " Packaging a new box " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box004.html#___sec14"> Packaging a new box </a>
     <!-- vagrant nav toc: " Installing packages in an empty Vagrant machine " --> <li> &nbsp;  <a href="._vagrant_box005.html#vagrant:empty:install"> Installing packages in an empty Vagrant machine </a>
     <!-- vagrant nav toc: " Scripts for installing ready-made packages " --> <li class="active"> &nbsp;  <a href="._vagrant_box006.html#vagrant:debpkg"> Scripts for installing ready-made packages </a>
     <!-- vagrant nav toc: " Setting up a default environment with <code>.bashrc</code> " --> <li> &nbsp;  <a href="._vagrant_box007.html#vagrant:bashrc"> Setting up a default environment with <code>.bashrc</code> </a>
     <!-- vagrant nav toc: " Operating the Vagrant machine " --> <li>  <a href="._vagrant_box008.html#___sec18"> Operating the Vagrant machine </a>
     <!-- vagrant nav toc: " Operating a complete Vagrant machine " --> <li> &nbsp;  <a href="._vagrant_box008.html#___sec19"> Operating a complete Vagrant machine </a>
     <!-- vagrant nav toc: " Operating an empty Vagrant machine " --> <li> &nbsp;  <a href="._vagrant_box008.html#___sec20"> Operating an empty Vagrant machine </a>
     <!-- vagrant nav toc: " Working with an initialized Vagrant machine " --> <li> &nbsp;  <a href="._vagrant_box008.html#___sec21"> Working with an initialized Vagrant machine </a>
     <!-- vagrant nav toc: " Shared directories " --> <li> &nbsp;  <a href="._vagrant_box008.html#vagrant:shareddir"> Shared directories </a>
     <!-- vagrant nav toc: " Troubleshooting " --> <li> &nbsp;  <a href="._vagrant_box009.html#___sec23"> Troubleshooting </a>
     <!-- vagrant nav toc: " Troubleshooting: shared directory is invisible " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box009.html#___sec24"> Troubleshooting: shared directory is invisible </a>
     <!-- vagrant nav toc: " Troubleshooting: "couldn't connect to display ..." " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box009.html#___sec25"> Troubleshooting: "couldn't connect to display ..." </a>
     <!-- vagrant nav toc: " Troubleshooting: Internet is not reachable " --> <li> &nbsp; &nbsp;  <a href="._vagrant_box009.html#___sec26"> Troubleshooting: Internet is not reachable </a>
     <!-- vagrant nav toc: " Stopping the Vagrant machine " --> <li> &nbsp;  <a href="._vagrant_box009.html#___sec27"> Stopping the Vagrant machine </a>
     <!-- vagrant nav toc: " Placing the Vagrant machine in the cloud " --> <li> &nbsp;  <a href="._vagrant_box009.html#___sec28"> Placing the Vagrant machine in the cloud </a>
     <!-- vagrant nav toc: " Using VMWare Fusion " --> <li> &nbsp;  <a href="._vagrant_box009.html#___sec29"> Using VMWare Fusion </a>
     <!-- vagrant nav toc: " Documentation of Vagrant " --> <li> &nbsp;  <a href="._vagrant_box009.html#___sec30"> Documentation of Vagrant </a>
     <!-- vagrant nav toc: " Appendix: Condensed instructions for students " --> <li>  <a href="._vagrant_box009.html#___sec31"> Appendix: Condensed instructions for students </a>
     <!-- vagrant nav toc: " Troubleshooting: shared directory is invisible " --> <li> &nbsp;  <a href="._vagrant_box009.html#___sec32"> Troubleshooting: shared directory is invisible </a>
     <!-- vagrant nav toc: " Troubleshooting: "couldn't connect to display ..." " --> <li> &nbsp;  <a href="._vagrant_box009.html#___sec33"> Troubleshooting: "couldn't connect to display ..." </a>
     <!-- vagrant nav toc: " Troubleshooting: Internet is not reachable " --> <li> &nbsp;  <a href="._vagrant_box009.html#___sec34"> Troubleshooting: Internet is not reachable </a>

    </ul>
   </div>
  </div>

  <div class="span9">


<!-- tocinfo
{'highest level': 1,
 'sections': [(' Problem setting ', 1, None, '___sec0'),
              (' Contents of the Vagrant machine ',
               2,
               'vagrant:contents',
               'vagrant:contents'),
              (' Installing the necessary software for using Vagrant ',
               2,
               'vagrant:install',
               'vagrant:install'),
              (' VirtualBox ', 3, None, '___sec3'),
              (' Vagrant ', 3, None, '___sec4'),
              (' Cygwin (only on Windows) ', 3, None, '___sec5'),
              (' Creating the Vagrant machine ', 1, None, '___sec6'),
              (' Choice of operating system type ', 2, None, '___sec7'),
              (' Downloading a base box to create a complete Vagrant machine ',
               2,
               None,
               '___sec8'),
              (' Making an empty Vagrant machine ', 2, None, '___sec9'),
              (' Installing packages in a complete Vagrant machine ',
               2,
               'vagrant:complete:install',
               'vagrant:complete:install'),
              (' Creating files ', 3, None, '___sec11'),
              (' Installing files and packages ', 3, None, '___sec12'),
              (' Enabling X11 graphics ', 3, None, '___sec13'),
              (' Packaging a new box ', 3, None, '___sec14'),
              (' Installing packages in an empty Vagrant machine ',
               2,
               'vagrant:empty:install',
               'vagrant:empty:install'),
              (' Scripts for installing ready-made packages ',
               2,
               'vagrant:debpkg',
               'vagrant:debpkg'),
              (' Setting up a default environment with `.bashrc` ',
               2,
               'vagrant:bashrc',
               'vagrant:bashrc'),
              (' Operating the Vagrant machine ', 1, None, '___sec18'),
              (' Operating a complete Vagrant machine ', 2, None, '___sec19'),
              (' Operating an empty Vagrant machine ', 2, None, '___sec20'),
              (' Working with an initialized Vagrant machine ',
               2,
               None,
               '___sec21'),
              (' Shared directories ',
               2,
               'vagrant:shareddir',
               'vagrant:shareddir'),
              (' Troubleshooting ', 2, None, '___sec23'),
              (' Troubleshooting: shared directory is invisible ',
               3,
               None,
               '___sec24'),
              (' Troubleshooting: "couldn\'t connect to display ..." ',
               3,
               None,
               '___sec25'),
              (' Troubleshooting: Internet is not reachable ',
               3,
               None,
               '___sec26'),
              (' Stopping the Vagrant machine ', 2, None, '___sec27'),
              (' Placing the Vagrant machine in the cloud ',
               2,
               None,
               '___sec28'),
              (' Using VMWare Fusion ', 2, None, '___sec29'),
              (' Documentation of Vagrant ', 2, None, '___sec30'),
              (' Appendix: Condensed instructions for students ',
               1,
               None,
               '___sec31'),
              (' Troubleshooting: shared directory is invisible ',
               2,
               None,
               '___sec32'),
              (' Troubleshooting: "couldn\'t connect to display ..." ',
               2,
               None,
               '___sec33'),
              (' Troubleshooting: Internet is not reachable ',
               2,
               None,
               '___sec34')]}
end of tocinfo -->





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">




<a name="part0006"></a>
<!-- !split -->

<h3>Scripts for installing ready-made packages <a name="vagrant:debpkg"></a></h3>

<p>
We have developed a little tool where one can list the desired Debian
or Python packages in a computing environment in a file with default name
<code>debkpg.txt</code>. This file may also contain plain Unix commands for
doing other types of installation, like <code>pip install</code>, or
cloning of source code repositories with subsequent execution of
a <code>setup.py</code> file. Concrete examples are listed below.

<p>
A little Python script <a href="https://github.com/hplgit/vagrantbox/tree/master/doc/src/vagrant/src-vagrant/deb2sh.py" target="_self"><tt>deb2sh.py</tt></a> reads the
installation specification in some file <a href="https://github.com/hplgit/vagrantbox/tree/master/doc/src/vagrant/src-vagrant/debpkg_minimal.txt" target="_self"><tt>debpkg_minimal.txt</tt></a> and
creates a Bash script <a href="https://github.com/hplgit/vagrantbox/tree/master/doc/src/vagrant/src-vagrant/install_minimal.sh" target="_self"><tt>install_minimal.sh</tt></a> and an
equivalent Python script <a href="https://github.com/hplgit/vagrantbox/tree/master/doc/src/vagrant/src-vagrant/install_minimal.py" target="_self"><tt>install_minimal.py</tt></a> for
running all the necessary operating system commands to install
all the packages in the correct order.  The script aborts if any package
cannot be installed successfully. The problem must
then be fixed, or the package must in worst case be removed (just
comment out the install line(s) in the Bash or Python script).  The
script can thereafter be rerun again.

<p>
The following is an extract of packages as they are listed
in the mentioned <code>debpkg_minimal.txt</code> file:

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"># Minimal installation for a Python ecosystem
# for scientific computing

# Editors
emacs python-mode gedit vim ispell

# Compilers
gcc g++ gawk f2c gfortran
autoconf automake autotools-dev

# Numerical libraries
libatlas-base-dev libsuitesparse-dev

# Python
idle
python-pip
python-dev
# Matplotlib requires libfreetype-dev libpng-dev
# (otherwise pip install matplotlib does not work)
libfreetype6-dev libpng-dev
pip install numpy
pip install sympy
#pip install matplotlib   # pip may fail for matplotlib
python-matplotlib
pip install scipy

# ScientificPython must be installed from source
$ if [ ! -d srclib ]; then mkdir srclib; fi
$ cd srclib
$ hg clone https://bitbucket.org/khinsen/scientificpython
$ cd scientificpython
$ sudo python setup.py install
$ cd ../..
</pre></div>
<p>
The syntax has four elements:

<p>

<ol>
<li> comment lines are just copied to the
   Bash and Python installation scripts,</li>
<li> lines starting with <code>$</code> are plain Unix
   commands and run by the installation scripts,</li>
<li> lines starting with
   <code>pip install</code> lists packages to be installed with <code>pip</code>, while</li>
<li> all other non-blank
   lines are supposed to list the name of Debian packages to be installed
   by <code>sudo apt-get install</code> commands.</li>
</ol>

The examples above show all four line types. Observe in particular how
we can freely add Unix commands to download <code>ScientificPython</code> from its
Bitbucket repo (done in the <code>srclib</code> subdirectory) and
install the package manually by running <code>setup.py</code> the usual way.

<p>
Some examples on lines in the automatically generated <code>install_minimal.sh</code>
script are

<p>

<!-- code=bash (from !bc shcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic">#!/bin/bash</span>
<span style="color: #408080; font-style: italic"># Automatically generated script. Based on debpkg.txt.</span>

<span style="color: #008000; font-weight: bold">function </span>apt_install <span style="color: #666666">{</span>
  sudo apt-get -y install <span style="color: #19177C">$1</span>
  <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">[</span> <span style="color: #19177C">$?</span> -ne 0 <span style="color: #666666">]</span>; <span style="color: #008000; font-weight: bold">then</span>
<span style="color: #008000; font-weight: bold">    </span><span style="color: #008000">echo</span> <span style="color: #BA2121">&quot;could not install $1 - abort&quot;</span>
    <span style="color: #008000">exit </span>1
  <span style="color: #008000; font-weight: bold">fi</span>
<span style="color: #666666">}</span>

<span style="color: #008000; font-weight: bold">function </span>pip_install <span style="color: #666666">{</span>
  <span style="color: #008000; font-weight: bold">for </span>p in <span style="color: #19177C">$@</span>; <span style="color: #008000; font-weight: bold">do</span>
<span style="color: #008000; font-weight: bold">    </span>sudo pip install <span style="color: #19177C">$p</span>
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">[</span> <span style="color: #19177C">$?</span> -ne 0 <span style="color: #666666">]</span>; <span style="color: #008000; font-weight: bold">then</span>
<span style="color: #008000; font-weight: bold">      </span><span style="color: #008000">echo</span> <span style="color: #BA2121">&quot;could not install $p - abort&quot;</span>
      <span style="color: #008000">exit </span>1
    <span style="color: #008000; font-weight: bold">fi</span>
<span style="color: #008000; font-weight: bold">  done</span>
<span style="color: #666666">}</span>

<span style="color: #008000; font-weight: bold">function </span>unix_command <span style="color: #666666">{</span>
  <span style="color: #19177C">$@</span>
  <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">[</span> <span style="color: #19177C">$?</span> -ne 0 <span style="color: #666666">]</span>; <span style="color: #008000; font-weight: bold">then</span>
<span style="color: #008000; font-weight: bold">    </span><span style="color: #008000">echo</span> <span style="color: #BA2121">&quot;could not run $@ - abort&quot;</span>
    <span style="color: #008000">exit </span>1
  <span style="color: #008000; font-weight: bold">fi</span>
<span style="color: #666666">}</span>

sudo apt-get update --fix-missing

<span style="color: #408080; font-style: italic"># Minimal installation for a Python ecosystem</span>
<span style="color: #408080; font-style: italic"># for scientific computing</span>

<span style="color: #408080; font-style: italic"># Editors</span>
apt_install python-mode gedit vim ispell
...
pip_install numpy
pip_install sympy
apt_install scipy
...
<span style="color: #408080; font-style: italic"># ScientificPython must be installed from source</span>
unix_command <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">[</span> ! -d srclib <span style="color: #666666">]</span>; <span style="color: #008000; font-weight: bold">then </span>mkdir srclib; <span style="color: #008000; font-weight: bold">fi</span>
unix_command <span style="color: #008000">cd </span>srclib
unix_command hg clone https://bitbucket.org/khinsen/scientificpython
unix_command <span style="color: #008000">cd </span>scientificpython
unix_command sudo python setup.py install
</pre></div>
<p>
<div class="alert alert-block alert-notice alert-text-normal"><b>Notice.</b>

<p>

<ul>
 <li> Installation commands may fail. Therefore we have made separate
   functions for doing the <code>apt-get</code> and <code>pip install</code> commands.
   We test the value of the environment variable <code>$?</code> after the
   installation of a package: a successful installation implies
   value of 0, while values different from 0 mean that something
   went wrong. We then abort the script with <code>exit 1</code>.</li>
 <li> The <code>apt-get install</code> command will prompt the user for questions for
   every package, but here we use the option <code>-y</code> to automatically
   rely on default answers, i.e., accepting <code>yes</code> to all questions.</li>
</ul>
</div>


<p>
The corresponding lines in the equivalent, automatically
generated <code>install.py</code> file look as follows.

<p>

<!-- code=python (from !bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">commands</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">sys</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">system</span>(cmd):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Run system command cmd.&quot;&quot;&quot;</span>
    failure, output <span style="color: #666666">=</span> commands<span style="color: #666666">.</span>getstatusoutput(cmd)
    <span style="color: #008000; font-weight: bold">if</span> failure:
       <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Command</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">  </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">failed.&#39;</span> <span style="color: #666666">%</span> cmd
       <span style="color: #008000; font-weight: bold">print</span> output
       sys<span style="color: #666666">.</span>exit(<span style="color: #666666">1</span>)

system(<span style="color: #BA2121">&#39;sudo apt-get update --fix-missing&#39;</span>)

system(<span style="color: #BA2121">&#39;sudo apt-get -y install python-mode gedit vim ispell&#39;</span>)
<span style="color: #666666">...</span>
system(<span style="color: #BA2121">&#39;pip install numpy&#39;</span>)
system(<span style="color: #BA2121">&#39;pip install sympy&#39;</span>)
system(<span style="color: #BA2121">&#39;sudo apt-get -y install scipy&#39;</span>)
<span style="color: #666666">...</span>
system(<span style="color: #BA2121">&#39;if [ ! -d srclib ]; then mkdir srclib; fi&#39;</span>)
system(<span style="color: #BA2121">&#39;cd srclib&#39;</span>)
sytem(<span style="color: #BA2121">&#39;hg clone https://bitbucket.org/khinsen/scientificpython&#39;</span>)
system(<span style="color: #BA2121">&#39; cd scientificpython&#39;</span>)
system(<span style="color: #BA2121">&#39;sudo python setup.py install&#39;</span>)
</pre></div>
<p>
The Python script does not test the Unix environment variable <code>$?</code>,
but the first return value from the <code>getstatusoutput</code> function acts as
the value of <code>$?</code>.

<p>
We can use the Bash or Python script to easily automate installation
of packages in the Vagrant machine. More powerful, industry standard
tools for setting up complete software environments are <a href="http://www.opscode.com/" target="_self">Chef</a> and <a href="https://puppetlabs.com/" target="_self">Puppet</a>.

<p>
<p>
<!-- ------------------- end of main content --------------- -->


<!--
Preliminary examples/discussion on vagrant style syntax

<div class='alert alert-block alert-notice'>
  <h3>What about PHP? Python? Java?</h3>
<p>
bla-bla.
</div>

<p>
While the <div class="deep-blue">rest of the</div> getting started
-->

<ul class="pager">
  <li class="previous">
    <a href="._vagrant_box005.html">&larr; Prev</a>
  </li>

  <li class="next">
    <a href="._vagrant_box007.html">Next &rarr;</a>
  </li>

</ul>

 </div>

 <div class="row Footer">
  <div class="span12">
  Copyright &copy 2013; Anders E. Johansen and Hans Petter Langtangen
  </div>
 </div>
</div>
</body>
</html>



